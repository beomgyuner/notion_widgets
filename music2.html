<head>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">

	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
</head>

<body>
	<div id="miniplay">

		<div class="stats">
			<div class="track-art"></div>
			<div class="now-playing">PLAYING x OF y</div>
			<div style="display:flex;flex-direction:column;padding:10px 0 10px 10px;">
				<div class="track-name">Track Name</div>
				<div style="font-size:8pt;color:grey;" class="track-artist">Track Artist</div>
			</div>
		</div>

		<div class="slider_container">
			<div class="current-time">00:00</div>
			<input type="range" min="1" max="100" value="0" class="seek_slider" onchange="seekTo()">
			<div class="total-duration">00:00</div>
		</div>

		<div class="bttn">
			<div class="prev-track" onclick="prevTrack()">
				<?xml version="1.0" ?><svg height="28" viewBox="0 0 512 512" width="28" xmlns="http://www.w3.org/2000/svg">
					<title />
					<path d="M30.71,229.47l188.87-113a30.54,30.54,0,0,1,31.09-.39,33.74,33.74,0,0,1,16.76,29.47V224.6L448.15,116.44a30.54,30.54,0,0,1,31.09-.39A33.74,33.74,0,0,1,496,145.52v221A33.73,33.73,0,0,1,479.24,396a30.54,30.54,0,0,1-31.09-.39L267.43,287.4v79.08A33.73,33.73,0,0,1,250.67,396a30.54,30.54,0,0,1-31.09-.39l-188.87-113a31.27,31.27,0,0,1,0-53Z" />
				</svg>
			</div>
			<div class="playpause-track" onclick="playpauseTrack()">
				<i class="fa fa-play fa-lg"></i>
			</div>
			<div class="next-track" onclick="nextTrack()">
				<?xml version="1.0" ?><svg height="28" viewBox="0 0 512 512" width="28" xmlns="http://www.w3.org/2000/svg">
					<title />
					<path d="M481.29,229.47l-188.87-113a30.54,30.54,0,0,0-31.09-.39,33.74,33.74,0,0,0-16.76,29.47V224.6L63.85,116.44a30.54,30.54,0,0,0-31.09-.39A33.74,33.74,0,0,0,16,145.52v221A33.74,33.74,0,0,0,32.76,396a30.54,30.54,0,0,0,31.09-.39L244.57,287.4v79.08A33.74,33.74,0,0,0,261.33,396a30.54,30.54,0,0,0,31.09-.39l188.87-113a31.27,31.27,0,0,0,0-53Z" />
				</svg>
			</div>
		</div>

	</div>

	</div>
</body>

<style>
	#miniplay {
		width: 18em;
		height: 10em;
		font-family: "Inter", serif;
		background: #F5F5F5;
		border: 1px solid #D6D6D6;
		border-radius: .625rem;
		box-shadow: inset 10px 0px 6px -10px #CCC, inset -10px 0px 6px -10px #CCC, inset 0px 10px 6px -10px #FFF, inset 0px -10px 6px -10px #CCC;
		padding: 12px;
		cursor: move;
	}

	.stats {
		display: flex;
		align-items: center;
	}

	.track-art {
		width: 3.5em;
		height: 3.5em;
		object-fit: cover;
		border-radius: 4px;
		background-size: cover;
		background-position: center;
	}

	.slider_container {
		display: flex;
		justify-content: center;
		align-items: center;
		margin: 12px 0 12px 0;
	}

	.current-time,
	.total-duration {
		color: #666;
		font-family: "Inter", serif;
		font-size: 12px;
		padding: 4px;
	}

	.seek_slider,
	.volume_slider {
		width: 100%;
	}

	.seek_slider,
	.volume_slider {
		-webkit-appearance: none;
		-moz-appearance: none;
		appearance: none;
		height: 3px;
		background: #bbb;
	}

	.seek_slider::-webkit-slider-thumb,
	.volume_slider::-webkit-slider-thumb {
		cursor: pointer;
	}

	.now-playing,
	.track-name,
	.track-artist {
		color: #555;
		font-size: 13px;
		font-weight: 500;
		line-height: 1.3;
	}

	.now-playing {
		display: none;
	}

	.bttn {
		display: flex;
		flex-direction: row;
		align-items: center;
		justify-content: center;
		gap: 14px;
	}

	.playpause-track,
	.prev-track,
	.next-track {
		opacity: 0.5;
		color: #000;
		transition: opacity 0.2s;
	}

	.playpause-track:hover,
	.prev-track:hover,
	.next-track:hover {
		opacity: 0.8;
	}

	i.fa-play,
	i.fa-pause,
	.prev-track,
	.next-track {
		cursor: pointer;
	}
</style>

<script>
	let now_playing = document.querySelector(".now-playing");
	let track_art = document.querySelector(".track-art");
	let track_name = document.querySelector(".track-name");
	let track_artist = document.querySelector(".track-artist");
	let playpause_btn = document.querySelector(".playpause-track");
	let next_btn = document.querySelector(".next-track");
	let prev_btn = document.querySelector(".prev-track");
	let seek_slider = document.querySelector(".seek_slider");
	let volume_slider = document.querySelector(".volume_slider");
	let curr_time = document.querySelector(".current-time");
	let total_duration = document.querySelector(".total-duration");
	// Specify globally used values
	let track_index = 0;
	let isPlaying = false;
	let updateTimer;
	// Create the audio element for the player
	let curr_track = document.createElement('audio');
	// Define the list of tracks that have to be played
	let track_list = [{
			name: "Red Angel",
			artist: "MAISON",
			image: "https://file.garden/aXTkw7hiK3vn4ais/%E2%9D%A6.jpg",
			path: "https://file.garden/aXTkw7hiK3vn4ais/Red%20Angel%20%5BZp63mZl2jMo%5D.mp3"
		},
		{
			name: "Sweet Crazy Love",
			artist: "MAISON",
			image: "https://file.garden/aXTkw7hiK3vn4ais/download%20(10).jpg",
			path: "https://file.garden/aXTkw7hiK3vn4ais/sweet%20crazy%20Love.mp3"
		},
	];
	//
	//
	function loadTrack(track_index) {
		// Clear the previous seek timer
		clearInterval(updateTimer);
		resetValues();
		// Load a new track
		curr_track.src = track_list[track_index].path;
		curr_track.load();
		// Update details of the track
		track_art.style.backgroundImage =
			"url(" + track_list[track_index].image + ")";
		track_name.textContent = track_list[track_index].name;
		track_artist.textContent = track_list[track_index].artist;
		now_playing.textContent =
			"PLAYING " + (track_index + 1) + " OF " + track_list.length;
		// Set an interval of 1000 milliseconds
		// for updating the seek slider
		updateTimer = setInterval(seekUpdate, 1000);
		// Move to the next track if the current finishes playing
		// using the 'ended' event
		curr_track.addEventListener("ended", nextTrack);
		// Apply a random background color
		random_bg_color();
	}
	// Function to reset all values to their default
	function resetValues() {
		curr_time.textContent = "00:00";
		total_duration.textContent = "00:00";
		seek_slider.value = 0;
	}

	function playpauseTrack() {
		// Switch between playing and pausing
		// depending on the current state
		if (!isPlaying) playTrack();
		else pauseTrack();
	}

	function playTrack() {
		// Play the loaded track
		curr_track.play();
		isPlaying = true;
		// Replace icon with the pause icon
		playpause_btn.innerHTML = '<i class="fa fa-pause fa-lg"></i>';
	}

	function pauseTrack() {
		// Pause the loaded track
		curr_track.pause();
		isPlaying = false;
		// Replace icon with the play icon
		playpause_btn.innerHTML = '<i class="fa fa-play fa-lg"></i>';
	}

	function nextTrack() {
		// Go back to the first track if the
		// current one is the last in the track list
		if (track_index < track_list.length - 1)
			track_index += 1;
		else track_index = 0;
		// Load and play the new track
		loadTrack(track_index);
		playTrack();
	}

	function prevTrack() {
		// Go back to the last track if the
		// current one is the first in the track list
		if (track_index > 0)
			track_index -= 1;
		else track_index = track_list.length - 1;
		// Load and play the new track
		loadTrack(track_index);
		playTrack();
	}

	function seekTo() {
		// Calculate the seek position by the
		// percentage of the seek slider
		// and get the relative duration to the track
		seekto = curr_track.duration * (seek_slider.value / 100);
		// Set the current track position to the calculated seek position
		curr_track.currentTime = seekto;
	}

	function setVolume() {
		// Set the volume according to the
		// percentage of the volume slider set
		curr_track.volume = volume_slider.value / 100;
	}

	function seekUpdate() {
		let seekPosition = 0;
		// Check if the current track duration is a legible number
		if (!isNaN(curr_track.duration)) {
			seekPosition = curr_track.currentTime * (100 / curr_track.duration);
			seek_slider.value = seekPosition;
			// Calculate the time left and the total duration
			let currentMinutes = Math.floor(curr_track.currentTime / 60);
			let currentSeconds = Math.floor(curr_track.currentTime - currentMinutes * 60);
			let durationMinutes = Math.floor(curr_track.duration / 60);
			let durationSeconds = Math.floor(curr_track.duration - durationMinutes * 60);
			// Add a zero to the single digit time values
			if (currentSeconds < 10) {
				currentSeconds = "0" + currentSeconds;
			}
			if (durationSeconds < 10) {
				durationSeconds = "0" + durationSeconds;
			}
			if (currentMinutes < 10) {
				currentMinutes = "0" + currentMinutes;
			}
			if (durationMinutes < 10) {
				durationMinutes = "0" + durationMinutes;
			}
			// Display the updated duration
			curr_time.textContent = currentMinutes + ":" + currentSeconds;
			total_duration.textContent = durationMinutes + ":" + durationSeconds;
		}
	}
	// Load the first track in the tracklist
	loadTrack(track_index);
</script>
